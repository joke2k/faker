# datetime_provider_en_af.py  (English - en_AF)

from faker.providers.date_time import Provider as DateTimeProvider
try:
    from jdatetime import date as jdate
except ImportError:
    # Fallback for testing when jdatetime is not installed
    from datetime import date as jdate
    # Add missing method
    def fromgregorian(date_obj):
        return date_obj
    jdate.fromgregorian = fromgregorian


class Provider(DateTimeProvider):
    """DateTime provider for English Afghanistan locale.
    Supports both Gregorian and Solar Hijri (Shamsi) dates."""

    # English month names for Solar Hijri
    shamsi_month_names = (
        "", "Hamal", "Sawr", "Jawza", "Saratān", "Asad", "Sonbola",
        "Mizān", "Aqrab", "Qaws", "Jadi", "Dalwa", "Hut"
    )

    def day_of_week(self) -> str:
        # Standard English day names
        return self.date_time().strftime("%A")

    def month_name_shamsi(self) -> str:
        jd = jdate.fromgregorian(date=self.date_object())
        return self.shamsi_month_names[jd.month]

    def date_shamsi(self, pattern: str = "%Y/%m/%d") -> str:
        """Returns Solar Hijri date, e.g., 1404/10/04"""
        gregorian_date = self.date_object()
        shamsi_date = jdate.fromgregorian(date=gregorian_date)
        return shamsi_date.strftime(pattern)

    def date_time_shamsi(self) -> str:
        """Example: Thursday, 4 Jadi 1404, 02:30 PM"""
        gregorian_dt = self.date_time()
        shamsi_date = jdate.fromgregorian(date=gregorian_dt.date())
        day_name = gregorian_dt.strftime("%A")
        month_name = self.shamsi_month_names[shamsi_date.month]
        time_str = gregorian_dt.strftime("%I:%M %p")
        return f"{day_name}, {shamsi_date.day} {month_name} {shamsi_date.year}, {time_str}"