# datetime_provider_ps_af.py  (Pashto - ps_AF)

from faker.providers.date_time import Provider as DateTimeProvider
import datetime
from jdatetime import date as jdate  # Requires: pip install jdatetime


class Provider(DateTimeProvider):
    """DateTime provider for Pashto Afghanistan using Solar Hijri (Shamsi) calendar."""

    # Pashto day names (starting from Saturday, as common in Afghanistan calendars)
    day_names = (
        "پيلنۍ",   # Saturday
        "يونۍ", # Sunday
        "دونۍ", # Monday
        "منځنۍ",# Tuesday
        "څلورنۍ",# Wednesday
        "پينځنۍ",# Thursday
        "جمعه",   # Friday
    )

    # Pashto month names (Solar Hijri)
    month_names = (
        "",  # index 0 unused
        "وری",     # Hamal (1)
        "غويی",    # Sawr (2)
        "غبرګولی", # Jawza (3)
        "چنګاښ",   # Saratān (4)
        "زمری",    # Asad (5)
        "وږی",     # Sonbola (6)
        "تله",     # Mizān (7)
        "لړم",     # Aqrab (8)
        "لیندۍ",   # Qaws (9)
        "مرغومی",  # Jadi (10)
        "سلواغه",  # Dalwa (11)
        "کب",      # Hut (12)
    )

    def day_of_week(self) -> str:
        day = self.date_object().weekday()  # 0 = Monday → adjust to Afghanistan (Saturday = 0)
        afg_index = (day + 2) % 7  # Shift so Saturday = 0
        return self.day_names[afg_index]

    def month_name(self) -> str:
        jd = jdate.fromgregorian(date=self.date_object())
        return self.month_names[jd.month]

    def date_shamsi(self, pattern: str = "%Y/%m/%d") -> str:
        """Returns date in Solar Hijri format. Default: ۱۴۰۴/۱۰/۴"""
        gregorian_date = self.date_object()
        shamsi_date = jdate.fromgregorian(date=gregorian_date)
        return shamsi_date.strftime(pattern)

    def date_time_shamsi(self) -> str:
        """Example: پنجشنبه، ۴ مرغومی ۱۴۰۴، ساعت ۱۴:۳۰"""
        gregorian_dt = self.date_time()
        shamsi_date = jdate.fromgregorian(date=gregorian_dt.date())
        day_name = self.day_of_week()
        hour = gregorian_dt.strftime("%H")
        minute = gregorian_dt.strftime("%M")
        return f"{day_name}، {shamsi_date.day} {self.month_names[shamsi_date.month]} {shamsi_date.year}، ساعت {hour}:{minute}"

    # Override default date() to optionally return Shamsi
    def date_object(self, *args, **kwargs):
        return super().date_object(*args, **kwargs)